#!/usr/bin/env bash

DOT="$HOME/.dotfiles"

# echo ""
# echo "Shutdown All VMs"
# vboxmanage list runningvms | sed -r 's/.*\{(.*)\}/\1/' | xargs -L1 -I {} VBoxManage controlvm {} savestate

echo ""
echo "Installing VirtualBox"
brew cask install virtualbox

echo ""
echo "Installing Vagrant"
brew cask install vagrant
brew cask cleanup

echo ""
echo "Download Base Boxes"
vagrant box add laravel/homestead
vagrant box add scotch/box
sleep 1

if [ ! -d "$HOME/.homestead" ]; then
  echo ""
  echo "Installing Homestead"
  composer global require "laravel/homestead=~2.0"
  homestead init
  echo "Copying Homestead Preferences"
  cp -RfXv $DOT/bin/homestead/after.sh $HOME/.homestead/after.sh
  cp -RfXv $DOT/bin/homestead/aliases $HOME/.homestead/aliases
fi
